<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUIX - Soldier Detail</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Roboto:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="public/js/auth.js" defer></script>
    <script src="public/js/notifications.js" defer></script>
    <script src="public/js/soldier-detail.js?v=2" defer></script>
</head>

<body>

    <!-- Sidebar -->
    <aside class="sidebar glass-panel"
        style="margin: 20px 0 20px 20px; height: calc(100vh - 40px); border-radius: 12px;">
        <div class="brand">
            <img src="assets/AUiX-Acronym-White-With-Accents-RGB.png" alt="AUIX" style="height: 50px; width: auto;">
        </div>

        <ul class="nav-menu">
            <a href="Dashboard.html" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                </svg>
                Dashboard
            </a>
            <a href="soldiers.html" class="nav-item active">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path
                        d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
                </svg>
                Soldiers
            </a>
            <a href="analytics.html" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path
                        d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" />
                </svg>
                Analytics
            </a>
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path
                        d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                </svg>
                Reports
            </a>
            <a href="events.html" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path
                        d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2zm-7 5h5v5h-5z" />
                </svg>
                Events
            </a>
        </ul>

        <div class="sidebar-footer">
            <div class="footer-icons">
                <a href="#" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path
                            d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.58 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
                    </svg>
                    Settings
                </a>
                <a href="login.html" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 24 24">
                        <path
                            d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" />
                    </svg>
                    Logout
                </a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-board">

        <!-- Header with Integrated Profile -->
        <header class="board-header-integrated">
            <a href="soldiers.html" class="back-button-compact" title="Back to Soldiers">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
                </svg>
            </a>

            <!-- Integrated Profile Info -->
            <div class="profile-info-integrated">
                <img src="https://i.pravatar.cc/150?img=12" class="profile-avatar-integrated" alt="Soldier Avatar">
                <div class="profile-details-integrated">
                    <h1>SGT. James Williams</h1>
                    <div class="profile-meta-integrated">
                        <span class="meta-item">ID: 91842</span>
                        <span class="meta-divider">‚Ä¢</span>
                        <span class="meta-item">E-5 Sergeant</span>
                        <span class="meta-divider">‚Ä¢</span>
                        <span class="meta-item">11B Infantry</span>
                        <span class="meta-divider">‚Ä¢</span>
                        <span class="meta-item">Charlie Company</span>
                    </div>
                </div>
            </div>

            <!-- Status & Actions -->
            <div class="header-status-actions">
                <div class="status-badge-integrated status-monitor">
                    <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" />
                    </svg>
                    MONITOR
                </div>
                <div class="sync-info-integrated">
                    <span class="sync-text-compact">Last sync: 2h ago</span>
                    <span class="completeness-label">Data:</span>
                    <span class="completeness-value">94%</span>
                </div>
                <div class="parameter-selector-integrated">
                    <label>Profile:</label>
                    <select id="parameterProfile" onchange="changeParameterProfile(this.value)">
                        <option value="training" selected>Training</option>
                        <option value="deployment">Deployment</option>
                        <option value="recovery">Recovery</option>
                    </select>
                </div>

                <!-- Notification Bell -->
                <div class="notification-container">
                    <svg class="notification-bell" viewBox="0 0 24 24" width="22" height="22" fill="none"
                        stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        onclick="toggleNotifications()">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span class="notification-badge" id="notificationBadge">1</span>

                    <div class="notifications-dropdown" id="notificationsDropdown">
                        <div class="notifications-header">
                            <h3>Notifications</h3>
                            <button class="mark-all-read" onclick="markAllRead()">Mark all read</button>
                        </div>
                        <div class="notifications-list">
                            <div class="notification-item notification-high">
                                <div class="notification-dot"></div>
                                <div class="notification-content">
                                    <div class="notification-title">HRV Below Baseline</div>
                                    <div class="notification-desc">SGT. Williams - HRV down 12% from baseline</div>
                                    <div class="notification-time">30 mins ago</div>
                                </div>
                            </div>
                        </div>
                        <div class="notifications-footer">
                            <a href="#" class="view-all-link">View all notifications</a>
                        </div>
                    </div>
                </div>
                <div class="user-profile-circle"></div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <div class="detail-tabs">
            <a href="javascript:void(0)" class="detail-tab-btn active" onclick="switchDetailTab('overview', this)">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                </svg>
                Overview
            </a>
            <a href="javascript:void(0)" class="detail-tab-btn" onclick="switchDetailTab('trends', this)">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z" />
                </svg>
                Trends
            </a>
            <a href="javascript:void(0)" class="detail-tab-btn" onclick="switchDetailTab('sleep', this)">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path
                        d="M9 11.75A5.29 5.29 0 0 0 14.25 17H17v-6.75A5.29 5.29 0 0 0 11.25 5 5.23 5.23 0 0 0 6 10.25h3z" />
                </svg>
                Sleep & Recovery
            </a>
            <a href="javascript:void(0)" class="detail-tab-btn" onclick="switchDetailTab('physiology', this)">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10zm-1-9h2v5h-2zm0-6h2v4h-2z" />
                </svg>
                Physiology
            </a>
            <a href="javascript:void(0)" class="detail-tab-btn" onclick="switchDetailTab('activity', this)">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path
                        d="M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z" />
                </svg>
                Activity
            </a>
            <a href="javascript:void(0)" class="detail-tab-btn" onclick="switchDetailTab('history', this)">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                    <path
                        d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z" />
                </svg>
                History
            </a>
        </div>

        <!-- Tab Content -->
        <div class="detail-content">

            <!-- OVERVIEW TAB -->
            <div id="overview-tab" class="detail-tab-content active">

                <!-- 18-Score Grid -->
                <div class="readiness-18-grid">
                    <!-- Section: Core Metrics (1-6) -->
                    <div class="grid-section">
                        <h3 class="section-divider">Core Readiness</h3>
                        <div class="score-cards">
                            <div class="score-card" id="card-readiness">
                                <div class="score-label">Overall Readiness</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-recovery">
                                <div class="score-label">Recovery Score</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-sleep_quality">
                                <div class="score-label">Sleep Index</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-fatigue_index">
                                <div class="score-label">Fatigue Index</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-training_load">
                                <div class="score-label">Endurance</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-cardiovascular_strain">
                                <div class="score-label">Cardio Fitness</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                        </div>
                    </div>

                    <!-- Section: Safety Metrics (7-12) -->
                    <div class="grid-section">
                        <h3 class="section-divider">Safety & Load</h3>
                        <div class="score-cards">
                            <div class="score-card" id="card-stress_load">
                                <div class="score-label">Stress Load</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-overtraining_risk">
                                <div class="score-label">Injury Risk</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-autonomic_balance">
                                <div class="score-label">Cardio Stability</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-illness_risk">
                                <div class="score-label">Illness Risk</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-physical_status">
                                <div class="score-label">Daily Activity</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-energy_availability">
                                <div class="score-label">Work Capacity</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                        </div>
                    </div>

                    <!-- Section: Specialty Metrics (13-18) -->
                    <div class="grid-section">
                        <h3 class="section-divider">Specialty Metrics</h3>
                        <div class="score-cards">
                            <div class="score-card" id="card-oxygen_stability">
                                <div class="score-label">Altitude Score</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-hrv_deviation">
                                <div class="score-label">Cardiac Safety</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-sleep_debt">
                                <div class="score-label">Sleep Debt</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-resting_hr_deviation">
                                <div class="score-label">Training Readiness</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-respiratory_stability">
                                <div class="score-label">Cognitive Alert</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                            <div class="score-card" id="card-acute_chronic_ratio">
                                <div class="score-label">Thermoregulatory</div>
                                <div class="score-value">--</div>
                                <div class="score-status">Pending</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Why Panel -->
                <div class="why-panel">
                    <h3>‚ö° Top Drivers Affecting Readiness</h3>
                    <div class="drivers-list">
                        <div class="driver-item negative">
                            <div class="driver-icon">‚Üì</div>
                            <div class="driver-content">
                                <div class="driver-label">Sleep Below Target</div>
                                <div class="driver-detail">6.2 hrs avg vs 8 hrs target (-22%)</div>
                            </div>
                            <div class="driver-impact">-12</div>
                        </div>
                        <div class="driver-item negative">
                            <div class="driver-icon">‚Üì</div>
                            <div class="driver-content">
                                <div class="driver-label">HRV Below Baseline</div>
                                <div class="driver-detail">58 ms vs 65 ms baseline (-10%)</div>
                            </div>
                            <div class="driver-impact">-8</div>
                        </div>
                        <div class="driver-item negative">
                            <div class="driver-icon">‚Üì</div>
                            <div class="driver-content">
                                <div class="driver-label">Fatigue Accumulation High</div>
                                <div class="driver-detail">45/100 fatigue index</div>
                            </div>
                            <div class="driver-impact">-6</div>
                        </div>
                        <div class="driver-item positive">
                            <div class="driver-icon">‚Üë</div>
                            <div class="driver-content">
                                <div class="driver-label">Recovery Improved</div>
                                <div class="driver-detail">82/100 recovery score (+15%)</div>
                            </div>
                            <div class="driver-impact">+5</div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- TRENDS TAB -->
            <div id="trends-tab" class="detail-tab-content">

                <!-- Main Readiness Trend -->
                <div class="widget">
                    <div class="widget-header">
                        Readiness Trend
                        <div class="toggle-buttons">
                            <button class="toggle-btn active" onclick="toggleReadinessTrend(30)">30 Days</button>
                            <button class="toggle-btn" onclick="toggleReadinessTrend(90)">90 Days</button>
                        </div>
                    </div>
                    <div class="chart-container chart-container-large">
                        <canvas id="readinessTrendChart"></canvas>
                    </div>
                </div>

                <!-- 4-Metric Mini Trends -->
                <div class="mini-trends-grid">
                    <div class="mini-trend-card">
                        <div class="mini-trend-header">
                            <div class="mini-trend-title">Sleep Hours</div>
                            <div class="mini-trend-value">6.2 <span class="trend-unit">hrs</span></div>
                        </div>
                        <canvas id="sleepMiniChart" height="60"></canvas>
                    </div>

                    <div class="mini-trend-card">
                        <div class="mini-trend-header">
                            <div class="mini-trend-title">HRV Score</div>
                            <div class="mini-trend-value">58 <span class="trend-unit">ms</span></div>
                        </div>
                        <canvas id="hrvMiniChart" height="60"></canvas>
                    </div>

                    <div class="mini-trend-card">
                        <div class="mini-trend-header">
                            <div class="mini-trend-title">Fatigue Index</div>
                            <div class="mini-trend-value">45 <span class="trend-unit">/100</span></div>
                        </div>
                        <canvas id="fatigueMiniChart" height="60"></canvas>
                    </div>

                    <div class="mini-trend-card">
                        <div class="mini-trend-header">
                            <div class="mini-trend-title">Recovery Score</div>
                            <div class="mini-trend-value">82 <span class="trend-unit">/100</span></div>
                        </div>
                        <canvas id="recoveryMiniChart" height="60"></canvas>
                    </div>
                </div>

                <!-- Distribution Panel -->
                <div class="widget">
                    <div class="widget-header">Last 30 Days Distribution</div>
                    <div class="distribution-stats">
                        <div class="dist-stat dist-fit">
                            <div class="dist-count">18</div>
                            <div class="dist-label">Fit Days</div>
                            <div class="dist-percent">60%</div>
                        </div>
                        <div class="dist-stat dist-monitor">
                            <div class="dist-count">8</div>
                            <div class="dist-label">Monitor Days</div>
                            <div class="dist-percent">27%</div>
                        </div>
                        <div class="dist-stat dist-risk">
                            <div class="dist-count">4</div>
                            <div class="dist-label">Risk Days</div>
                            <div class="dist-percent">13%</div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="distributionChart"></canvas>
                    </div>
                </div>

            </div>

            <!-- SLEEP & RECOVERY TAB -->
            <div id="sleep-tab" class="detail-tab-content">

                <!-- Sleep Hours Trend -->
                <div class="widget">
                    <div class="widget-header">
                        Sleep Hours Trend
                        <div class="toggle-buttons">
                            <button class="toggle-btn active" onclick="toggleSleepPeriod(7)">7 Days</button>
                            <button class="toggle-btn" onclick="toggleSleepPeriod(30)">30 Days</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="sleepHoursChart"></canvas>
                    </div>
                </div>

                <!-- Sleep Quality & Debt -->
                <div class="analytics-grid-2x2">
                    <div class="widget">
                        <div class="widget-header">Sleep Quality Score</div>
                        <div class="chart-container">
                            <canvas id="sleepQualityChart"></canvas>
                        </div>
                    </div>

                    <div class="widget">
                        <div class="widget-header">Sleep Debt Accumulation</div>
                        <div class="chart-container">
                            <canvas id="sleepDebtChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recovery & Recommendations -->
                <div class="analytics-grid-2x2">
                    <div class="widget">
                        <div class="widget-header">Recovery Score</div>
                        <div class="recovery-gauge-container">
                            <div class="circular-gauge-large" data-value="82">
                                <svg viewBox="0 0 200 200">
                                    <circle cx="100" cy="100" r="85" fill="none" stroke="#334155" stroke-width="15" />
                                    <circle cx="100" cy="100" r="85" fill="none" stroke="#06b6d4" stroke-width="15"
                                        stroke-dasharray="534" stroke-dashoffset="96" stroke-linecap="round"
                                        transform="rotate(-90 100 100)" class="gauge-arc" />
                                    <text x="100" y="90" class="gauge-value-large" text-anchor="middle">82</text>
                                    <text x="100" y="115" class="gauge-label-large" text-anchor="middle">Recovery</text>
                                    <text x="100" y="135" class="gauge-sublabel" text-anchor="middle">Weekly Avg:
                                        76</text>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="widget">
                        <div class="widget-header">Recovery Recommendations</div>
                        <div class="recommendations-list">
                            <div class="recommendation-item recommendation-caution">
                                <div class="rec-icon">‚ö†Ô∏è</div>
                                <div class="rec-content">
                                    <div class="rec-title">Moderate Training Recommended</div>
                                    <div class="rec-desc">Recovery is adequate but sleep debt is accumulating. Consider
                                        lighter intensity tomorrow.</div>
                                </div>
                            </div>
                            <div class="recommendation-item recommendation-info">
                                <div class="rec-icon">üí°</div>
                                <div class="rec-content">
                                    <div class="rec-title">Sleep Target Priority</div>
                                    <div class="rec-desc">Focus on achieving 8+ hours sleep tonight to reduce
                                        accumulated debt of 4.8 hours.</div>
                                </div>
                            </div>
                            <div class="recommendation-item recommendation-success">
                                <div class="rec-icon">‚úì</div>
                                <div class="rec-content">
                                    <div class="rec-title">Recovery Trend Positive</div>
                                    <div class="rec-desc">Recovery score improved 15% this week. Continue current
                                        recovery protocols.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- PHYSIOLOGY TAB -->
            <div id="physiology-tab" class="detail-tab-content">

                <!-- Resting HR & HRV -->
                <div class="analytics-grid-2x2">
                    <div class="widget">
                        <div class="widget-header">Resting Heart Rate</div>
                        <div class="chart-container">
                            <canvas id="restingHrChart"></canvas>
                        </div>
                    </div>

                    <div class="widget">
                        <div class="widget-header">HRV (Heart Rate Variability)</div>
                        <div class="chart-container">
                            <canvas id="hrvChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Heart Rate Zones (Inspired by Reference) -->
                <div class="widget">
                    <div class="widget-header">Heart Rate Zones (Today)</div>
                    <div class="hr-zones-container">
                        <div class="zone-legend">
                            <div class="zone-item"><span class="zone-dot zone-light"></span> Light (120-140 bpm)</div>
                            <div class="zone-item"><span class="zone-dot zone-intensive"></span> Intensive (140-160 bpm)
                            </div>
                            <div class="zone-item"><span class="zone-dot zone-aerobic"></span> Aerobic (160-175 bpm)
                            </div>
                            <div class="zone-item"><span class="zone-dot zone-anaerobic"></span> Anaerobic (175+ bpm)
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="hrZonesChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Baseline Comparison -->
                <div class="widget">
                    <div class="widget-header">Baseline Comparison</div>
                    <div class="baseline-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Baseline</th>
                                    <th>Last 7 Days</th>
                                    <th>Deviation</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>HRV</td>
                                    <td>65 ms</td>
                                    <td>58 ms</td>
                                    <td class="deviation-negative">-10.8%</td>
                                    <td><span class="status-icon status-warning">‚ö†Ô∏è</span></td>
                                </tr>
                                <tr>
                                    <td>Resting HR</td>
                                    <td>55 bpm</td>
                                    <td>60 bpm</td>
                                    <td class="deviation-negative">+9.1%</td>
                                    <td><span class="status-icon status-warning">‚ö†Ô∏è</span></td>
                                </tr>
                                <tr>
                                    <td>SpO‚ÇÇ</td>
                                    <td>98%</td>
                                    <td>97%</td>
                                    <td class="deviation-neutral">-1.0%</td>
                                    <td><span class="status-icon status-ok">‚úì</span></td>
                                </tr>
                                <tr>
                                    <td>Respiration</td>
                                    <td>14 bpm</td>
                                    <td>14 bpm</td>
                                    <td class="deviation-neutral">0.0%</td>
                                    <td><span class="status-icon status-ok">‚úì</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>

            <!-- ACTIVITY TAB -->
            <div id="activity-tab" class="detail-tab-content">

                <!-- Weekly Load (Inspired by Reference Steps Chart) -->
                <div class="widget">
                    <div class="widget-header">Weekly Training Load</div>
                    <div class="chart-container chart-container-large">
                        <canvas id="weeklyLoadChart"></canvas>
                    </div>
                </div>

                <!-- Steps & Energy -->
                <div class="analytics-grid-2x2">
                    <div class="widget">
                        <div class="widget-header">Daily Steps</div>
                        <div class="chart-container">
                            <canvas id="stepsChart"></canvas>
                        </div>
                    </div>

                    <div class="widget">
                        <div class="widget-header">Active Energy (Calories)</div>
                        <div class="chart-container">
                            <canvas id="activeEnergyChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Load/Recovery Ratio & Overtraining Risk -->
                <div class="analytics-grid-2x2">
                    <div class="widget">
                        <div class="widget-header">Load vs Recovery Balance</div>
                        <div class="chart-container">
                            <canvas id="loadRecoveryChart"></canvas>
                        </div>
                    </div>

                    <div class="widget">
                        <div class="widget-header">Overtraining Risk Assessment</div>
                        <div class="overtraining-panel">
                            <div class="risk-level risk-moderate">
                                <div class="risk-icon">‚ö†Ô∏è</div>
                                <div class="risk-label">MODERATE RISK</div>
                                <div class="risk-score">45/100</div>
                            </div>
                            <div class="risk-factors">
                                <div class="risk-factor">
                                    <span class="factor-icon trend-up">‚Üë</span>
                                    <span class="factor-text">Training load increased 3 consecutive days</span>
                                </div>
                                <div class="risk-factor">
                                    <span class="factor-icon trend-down">‚Üì</span>
                                    <span class="factor-text">Recovery score below 70 for 2 days</span>
                                </div>
                                <div class="risk-factor">
                                    <span class="factor-icon trend-down">‚Üì</span>
                                    <span class="factor-text">HRV -12% from baseline</span>
                                </div>
                            </div>
                            <div class="risk-recommendation">
                                <strong>Recommendation:</strong> Schedule rest day or light activity within next 48
                                hours.
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- HISTORY TAB -->
            <div id="history-tab" class="detail-tab-content">

                <div class="widget">
                    <div class="widget-header">Event Timeline</div>

                    <div class="timeline-container">

                        <div class="timeline-item">
                            <div class="timeline-date">Jan 4, 2026</div>
                            <div class="timeline-event event-alert">
                                <div class="event-icon">‚ö†Ô∏è</div>
                                <div class="event-content">
                                    <div class="event-title">High Fatigue Detected</div>
                                    <div class="event-desc">Readiness dropped to 67 (Monitor status)</div>
                                    <div class="event-impact">Impact: -8 readiness points</div>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-date">Jan 1, 2026</div>
                            <div class="timeline-event event-training">
                                <div class="event-icon">üèãÔ∏è</div>
                                <div class="event-content">
                                    <div class="event-title">High-Load Training Week</div>
                                    <div class="event-desc">Completed intense training cycle</div>
                                    <div class="event-impact">Load: 2850 intensity points</div>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-date">Dec 28, 2025</div>
                            <div class="timeline-event event-pt">
                                <div class="event-icon">üéØ</div>
                                <div class="event-content">
                                    <div class="event-title">PT Test Completed</div>
                                    <div class="event-desc">Score: 285 (Excellent)</div>
                                    <div class="event-impact">Readiness: 88 at time of test</div>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-date">Dec 20, 2025</div>
                            <div class="timeline-event event-parameter">
                                <div class="event-icon">‚öôÔ∏è</div>
                                <div class="event-content">
                                    <div class="event-title">Parameter Profile Changed</div>
                                    <div class="event-desc">Switched from Deployment ‚Üí Training Mode</div>
                                    <div class="event-impact">Weight adjustments applied</div>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-date">Dec 15, 2025</div>
                            <div class="timeline-event event-medical">
                                <div class="event-icon">üè•</div>
                                <div class="event-content">
                                    <div class="event-title">Medical: Minor Injury</div>
                                    <div class="event-desc">Light duty for 2 days (ankle sprain)</div>
                                    <div class="event-impact">Training load reduced 60%</div>
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-date">Dec 10, 2025</div>
                            <div class="timeline-event event-mission">
                                <div class="event-icon">üéØ</div>
                                <div class="event-content">
                                    <div class="event-title">Mission Day</div>
                                    <div class="event-desc">Field training exercise (48hr duration)</div>
                                    <div class="event-impact">Sleep debt accumulated: -6 hours</div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>

    </main>

    <!-- Score Explainer Drawer -->
    <div class="score-drawer" id="scoreDrawer">
        <div class="drawer-header">
            <h2>Readiness Score Breakdown</h2>
            <button class="drawer-close" onclick="closeScoreExplainer()">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path
                        d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                </svg>
            </button>
        </div>
        <div class="drawer-content">
            <div class="profile-mode">
                <strong>Current Profile:</strong> <span id="currentProfileName">Training Mode</span>
            </div>

            <h3>Component Weights</h3>
            <div class="component-weights">
                <div class="weight-item">
                    <div class="weight-label">Sleep Quality (25%)</div>
                    <div class="weight-bar-container">
                        <div class="weight-bar" style="width: 85%;"></div>
                    </div>
                    <div class="weight-score">85/100</div>
                </div>
                <div class="weight-item">
                    <div class="weight-label">HRV Score (25%)</div>
                    <div class="weight-bar-container">
                        <div class="weight-bar" style="width: 62%;"></div>
                    </div>
                    <div class="weight-score">62/100</div>
                </div>
                <div class="weight-item">
                    <div class="weight-label">Fatigue Index (30%) - inverted</div>
                    <div class="weight-bar-container">
                        <div class="weight-bar" style="width: 55%;"></div>
                    </div>
                    <div class="weight-score">55/100</div>
                </div>
                <div class="weight-item">
                    <div class="weight-label">Recovery Score (20%)</div>
                    <div class="weight-bar-container">
                        <div class="weight-bar" style="width: 82%;"></div>
                    </div>
                    <div class="weight-score">82/100</div>
                </div>
            </div>

            <h3>Formula Calculation</h3>
            <div class="formula-box">
                <div class="formula-line">Readiness = (0.25 √ó 85) + (0.25 √ó 62) + (0.30 √ó (100-55)) + (0.20 √ó 82)</div>
                <div class="formula-line">= 21.25 + 15.5 + 13.5 + 16.4</div>
                <div class="formula-result">= 66.65 ‚âà <strong>67/100</strong></div>
            </div>

            <div class="status-interpretation">
                <div class="status-badge-drawer status-monitor">MONITOR</div>
                <div class="status-range">Range: 50-70 points</div>
            </div>
        </div>
    </div>

</body>

</html>